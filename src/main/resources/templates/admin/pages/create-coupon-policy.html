<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>쿠폰 정책 생성</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
</head>
<body>
<div th:fragment="createCouponPolicyFragment('couponTypes')" class="container mt-5">
    <h3>쿠폰 정책 생성</h3>
    <form th:action="@{/admin/coupons/policies}" method="post" class="needs-validation">
        <div class="form-group">
            <label for="name">정책 이름</label>
            <input type="text" class="form-control" id="name" name="name" placeholder="정책 이름을 입력하세요" required>
            <div class="invalid-feedback">
                정책 이름을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="discountType">할인 타입</label>
            <select class="form-control" id="discountType" name="discountType" required>
                <option value="" disabled selected>할인 타입을 선택하세요</option>
                <option value="RATE">할인율</option>
                <option value="AMOUNT">할인 금액</option>
            </select>
            <div class="invalid-feedback">
                할인 타입을 선택하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="discountRate">할인율</label>
            <input type="number" step="0.01" class="form-control" id="discountRate" name="discountRate"
                   placeholder="할인율을 입력하세요">
            <div class="invalid-feedback">
                할인율을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="discountAmount">할인 금액</label>
            <input type="number" class="form-control" id="discountAmount"
                   name="discountAmount" placeholder="할인 금액을 입력하세요" required>
            <div class="invalid-feedback">
                할인 금액을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="standardPrice">기준 금액</label>
            <input type="number" class="form-control" id="standardPrice" name="standardPrice"
                   placeholder="기준 금액을 입력하세요" required>
            <div class="invalid-feedback">
                기준 금액을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="maxDiscountAmount">최대 할인 금액</label>
            <input type="number" class="form-control" id="maxDiscountAmount" name="maxDiscountAmount"
                   placeholder="최대 할인 금액을 입력하세요" required>
            <div class="invalid-feedback">
                최대 할인 금액을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="period">쿠폰 사용 기간 (일)</label>
            <input type="number" class="form-control" id="period" name="period" placeholder="쿠폰 사용 기간을 입력하세요" required>
            <div class="invalid-feedback">
                쿠폰 사용 기간을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="startDate">쿠폰 다운로드 시작일</label>
            <input type="date" class="form-control" id="startDate" name="startDate" required>
            <div class="invalid-feedback">
                쿠폰 다운로드 시작일을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="endDate">쿠폰 다운로드 종료일</label>
            <input type="date" class="form-control" id="endDate" name="endDate" required>
            <div class="invalid-feedback">
                쿠폰 다운로드 종료일을 입력하세요.
            </div>
        </div>
        <div class="form-group">
            <label for="couponTypeResponse">쿠폰 타입</label>
            <select class="form-control" id="couponTypeResponse" name="couponType" required>
                <option value="" disabled selected>쿠폰 타입을 선택하세요</option>
                <option th:each="type : ${couponTypes}" th:value="${type.name}" th:text="${type.name}">쿠폰 타입</option>
            </select>
            <div class="invalid-feedback">
                쿠폰 타입을 선택하세요.
            </div>
        </div>
        <div id="searchContainer"></div>
        <button type="submit" class="btn btn-primary">생성</button>
        <a href="/admin/coupons" class="btn btn-secondary">취소</a>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('DOM fully loaded and parsed');
        const couponTypeSelect = document.getElementById('couponTypeResponse');
        const searchContainer = document.getElementById('searchContainer');

        couponTypeSelect.addEventListener('change', function () {
            console.log("클릭됨");
            const selectedValue = this.value;
            searchContainer.innerHTML = '';

            if (selectedValue === 'book') {
                const bookSearch = document.createElement('div');
                bookSearch.className = 'form-group';
                bookSearch.innerHTML = `
                    <label for="bookSearch">책 검색</label>
                    <input type="text" class="form-control" id="bookSearch" name="bookSearch" placeholder="책 정보를 입력하세요">
                `;
                searchContainer.appendChild(bookSearch);
            } else if (selectedValue === 'category') {
                const categorySearch = document.createElement('div');
                categorySearch.className = 'form-group';
                categorySearch.innerHTML = `
                    <label for="categorySearch">카테고리 검색</label>
                    <input type="text" class="form-control" id="categorySearch" name="categorySearch" placeholder="카테고리 정보를 입력하세요">
                `;
                searchContainer.appendChild(categorySearch);
            }
        });
    });
</script>

</body>
</html>